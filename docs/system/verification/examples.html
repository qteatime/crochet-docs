<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Contracts" href="contracts.html" /><link rel="prev" title="Verification" href="index.html" />

    <meta name="generator" content="sphinx-4.1.1, furo 2021.07.05.beta38"/>
        <title>Example-based testing - Crochet 0.12 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/crochet.css" />
    


<style>
  :root {
    --color-code-background: #ffffff;
  --color-code-foreground: black;
  
  }
  @media (prefers-color-scheme: dark) {
    :root {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }

  /* For allowing end-user-specific overrides */
  .override-light {
    --color-code-background: #ffffff;
  --color-code-foreground: black;
  
  }
  .override-dark {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
</style><link media="(prefers-color-scheme: dark)" rel="stylesheet" href="../../_static/pygments_dark.css"></head>
  <body dir="">
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke-width="1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z"/>
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
      class="feather feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
      class="feather feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Crochet 0.12 documentation</div></a>
    </div>
    <div class="header-right">
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">Crochet 0.12 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html">
  <input class="sidebar-search" placeholder=Search name="q">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">The Crochet System</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label for="toctree-checkbox-1"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../whats-crochet.html">What’s Crochet?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installing-crochet.html">Installing Crochet</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../structure/index.html">How is Crochet structured?</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label for="toctree-checkbox-2"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../structure/introduction.html">The Crochet universe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../structure/package-configuration.html">Package configuration</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../types/index.html">Data and types</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label for="toctree-checkbox-3"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../types/types-and-data.html">Types and data modelling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../types/hierarchies.html">Hierarchies of types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../types/traits.html">Traits</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../commands/index.html">Commands</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label for="toctree-checkbox-4"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../commands/declaration.html">What are commands?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/signatures.html">Signatures and their uses</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/dispatch.html">Executing commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/why.html">Why are commands …?</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../computing/index.html">Computing with Crochet</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label for="toctree-checkbox-5"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../computing/execution-models.html">Execution models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../computing/bindings.html">Naming values</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../computing/intrinsics/index.html">Intrinsic data types</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label for="toctree-checkbox-6"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../computing/intrinsics/gradual.html">Gradual representations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../computing/intrinsics/numbers.html">Numeric models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../computing/intrinsics/text.html">Textual models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../computing/intrinsics/logic.html">Logical models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../computing/intrinsics/functions.html">Program representations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../computing/intrinsics/collections.html">Collections</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../computing/application.html">Applying programs and commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="../computing/using.html">Using data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../computing/equality.html">Equality</a></li>
<li class="toctree-l3"><a class="reference internal" href="../computing/branching.html">Branching</a></li>
<li class="toctree-l3"><a class="reference internal" href="../computing/comprehension.html">Working with multiple values</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../effects/index.html">Effects</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label for="toctree-checkbox-7"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../effects/what-are-effects.html">What are effects?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../effects/handlers.html">Effect handlers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../effects/contexts.html">Contextual handlers</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">Verification</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label for="toctree-checkbox-8"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Example-based testing</a></li>
<li class="toctree-l3"><a class="reference internal" href="contracts.html">Contracts</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../ffi/index.html">Foreign interfaces</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label for="toctree-checkbox-9"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../ffi/interface.html">Writing external functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ffi/ffi.html">The FFI type</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../security/index.html">Security and capabilities</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label for="toctree-checkbox-10"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../security/why.html">Why use capabilities?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/groups.html">Capabilities and groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/dynamic.html">Dynamic capabilities</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../design-philosophy.html">Annex A: Design philosophy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sociology-and-linguistics.html">Annex B: Sociology and linguistics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <main class="main">
    <div class="content">
      <article role="main">
        <label class="toc-overlay-icon toc-content-icon" for="__toc">
          <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
        </label>
        <div class="section" id="example-based-testing">
<h1>Example-based testing<a class="headerlink" href="#example-based-testing" title="Permalink to this headline">¶</a></h1>
<p>The simplest form of verification in Crochet is the use of examples.
In this form one has a specific scenario of the program in mind,
and then verifies that the program behaves in that specific way.
Examples are used for verifying small pieces of the program,
rather than the entire program. And this process is generally
called “unit testing”.</p>
<div class="section" id="test-declarations">
<h2>Test declarations<a class="headerlink" href="#test-declarations" title="Permalink to this headline">¶</a></h2>
<p>Crochet’s support for example testing comes in the form of
test declarations. Each of these test declarations can cover
one of these scenarios, and verifications are done with the
<code class="docutils literal notranslate"><span class="pre">assert</span></code> expression.</p>
<p>For example, consider the case where we have a command to
display the list of items in an inventory with your usual
English conjunctions. An example test for it could look
like the following:</p>
<div class="highlight-crochet notranslate"><div class="highlight"><pre><span></span><span class="k">test</span> <span class="dl">"</span><span class="s2">inventory display with conjunctions</span><span class="dl">"</span> <span class="k">do</span>
  <span class="k">assert</span> <span class="p">(</span><span class="o">#</span>inventory <span class="nf">with:</span> <span class="p">[]</span> <span class="p">|</span> show<span class="p">)</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">You're not carrying anything.</span><span class="dl">"</span><span class="p">;</span>

  <span class="k">assert</span> <span class="p">(</span><span class="o">#</span>inventory <span class="nf">with:</span> <span class="p">[</span>rose<span class="p">]</span> <span class="p">|</span> show<span class="p">)</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">You're carrying </span><span class="si">[</span>rose<span class="si">]</span><span class="s2">.</span><span class="dl">"</span><span class="p">;</span>

  <span class="k">assert</span> <span class="p">(</span><span class="o">#</span>inventory <span class="nf">with:</span> <span class="p">[</span>rose<span class="p">,</span> watch<span class="p">,</span> old-coin<span class="p">]</span> <span class="p">|</span> show<span class="p">)</span>
    <span class="o">===</span> <span class="dl">"</span><span class="s2">You're carrying </span><span class="si">[</span>rose<span class="si">]</span><span class="s2">, </span><span class="si">[</span>watch<span class="si">]</span><span class="s2">, and </span><span class="si">[</span>old-coin<span class="si">]</span><span class="s2">.</span><span class="dl">"</span><span class="p">;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>Here we have three different <code class="docutils literal notranslate"><span class="pre">assert</span></code> expressions that verify
different possibilities of displaying an inventory. When one isn’t
carrying anything, “You’re not carrying anything.” should be displayed.
But when they’re carrying multiple items, we’d expect something
more along the lines of “You’re carrying a rose, a watch, and an old coin.”.</p>
<div class="section" id="convenience-for-command-tests">
<h3>Convenience for command tests<a class="headerlink" href="#convenience-for-command-tests" title="Permalink to this headline">¶</a></h3>
<p>Though you can always use the test declaration syntax, there’s a slightly
more convenient syntax for describing examples for a single command.
Instead of writing the separated test declaration, as above, we could
have added a test block to the <code class="docutils literal notranslate"><span class="pre">inventory</span> <span class="pre">show:</span> <span class="pre">_</span></code> command itself:</p>
<div class="highlight-crochet notranslate"><div class="highlight"><pre><span></span><span class="k">command</span> inventory show <span class="k">do</span>
  <span class="k">condition</span>
    <span class="k">when</span> self.items is-empty <span class="o">=&gt;</span> <span class="p">...;</span>
    <span class="k">when</span> self.items size <span class="o">===</span> <span class="mf">1</span> <span class="o">=&gt;</span> <span class="p">...;</span>
    <span class="k">otherwise</span> <span class="o">=&gt;</span> <span class="p">...;</span>
  <span class="k">end</span>

<span class="k">test</span>
  <span class="k">assert</span> <span class="p">(</span><span class="o">#</span>inventory <span class="nf">with:</span> <span class="p">[]</span> <span class="p">|</span> show<span class="p">)</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">You're not carrying anything.</span><span class="dl">"</span><span class="p">;</span>

  <span class="k">assert</span> <span class="p">(</span><span class="o">#</span>inventory <span class="nf">with:</span> <span class="p">[</span>rose<span class="p">]</span> <span class="p">|</span> show<span class="p">)</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">You're carrying </span><span class="si">[</span>rose<span class="si">]</span><span class="s2">.</span><span class="dl">"</span><span class="p">;</span>

  <span class="k">assert</span> <span class="p">(</span><span class="o">#</span>inventory <span class="nf">with:</span> <span class="p">[</span>rose<span class="p">,</span> watch<span class="p">,</span> old-coin<span class="p">]</span> <span class="p">|</span> show<span class="p">)</span>
    <span class="o">===</span> <span class="dl">"</span><span class="s2">You're carrying </span><span class="si">[</span>rose<span class="si">]</span><span class="s2">, </span><span class="si">[</span>watch<span class="si">]</span><span class="s2">, and </span><span class="si">[</span>old-coin<span class="si">]</span><span class="s2">.</span><span class="dl">"</span><span class="p">;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>This convenience syntax works exactly like the separated test declaration,
but it uses the name of the command as a description.</p>
</div>
</div>
<div class="section" id="testing-effects">
<h2>Testing effects<a class="headerlink" href="#testing-effects" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Effectful testing is still in discovery; this section will be
expanded in the future.</p>
</div>
<p>When the pieces of program you want to test only depend on the data
you’re using, your examples will consist of constructing the data,
executing a command, and then comparing the resulting data with
what you expected to happen.</p>
<p>But testing programs that have effects requires more sophisticated
examples. And that’s because effects usually do things outside
of what can be reasonably verified in Crochet. So one approach to
testing these programs is to use a handler that, instead of
doing things outside of Crochet, just keeps track of what was
supposed to happen. The examples may then verify that what was
supposed to happen in the program really matches what the program
should be doing.</p>
</div>
</div>

      </article>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="contracts.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Contracts</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Verification</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; 2021, Q.
            |
            Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
              and
              <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
              <a href="https://github.com/pradyunsg/furo">Furo theme</a>.
            |
            <a class="muted-link" href="../../_sources/system/verification/examples.rst.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Example-based testing</a><ul>
<li><a class="reference internal" href="#test-declarations">Test declarations</a><ul>
<li><a class="reference internal" href="#convenience-for-command-tests">Convenience for command tests</a></li>
</ul>
</li>
<li><a class="reference internal" href="#testing-effects">Testing effects</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </main>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/scripts/main.js"></script>
    </body>
</html>