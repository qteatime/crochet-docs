<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Why are commands …?" href="why.html" /><link rel="prev" title="Signatures and their uses" href="signatures.html" />

    <meta name="generator" content="sphinx-4.1.1, furo 2021.07.05.beta38"/>
        <title>Executing commands - Crochet 0.12 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/crochet.css" />
    


<style>
  :root {
    --color-code-background: #ffffff;
  --color-code-foreground: black;
  
  }
  @media (prefers-color-scheme: dark) {
    :root {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }

  /* For allowing end-user-specific overrides */
  .override-light {
    --color-code-background: #ffffff;
  --color-code-foreground: black;
  
  }
  .override-dark {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
</style><link media="(prefers-color-scheme: dark)" rel="stylesheet" href="../../_static/pygments_dark.css"></head>
  <body dir="">
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke-width="1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z"/>
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
      class="feather feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
      class="feather feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Crochet 0.12 documentation</div></a>
    </div>
    <div class="header-right">
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">Crochet 0.12 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html">
  <input class="sidebar-search" placeholder=Search name="q">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">The Crochet System</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label for="toctree-checkbox-1"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../whats-crochet.html">What’s Crochet?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installing-crochet.html">Installing Crochet</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../structure/index.html">How is Crochet structured?</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label for="toctree-checkbox-2"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../structure/introduction.html">The Crochet universe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../structure/package-configuration.html">Package configuration</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../types/index.html">Data and types</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label for="toctree-checkbox-3"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../types/types-and-data.html">Types and data modelling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../types/hierarchies.html">Hierarchies of types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../types/traits.html">Traits</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">Commands</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label for="toctree-checkbox-4"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="declaration.html">What are commands?</a></li>
<li class="toctree-l3"><a class="reference internal" href="signatures.html">Signatures and their uses</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Executing commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="why.html">Why are commands …?</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../computing/index.html">Computing with Crochet</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label for="toctree-checkbox-5"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../computing/execution-models.html">Execution models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../computing/bindings.html">Naming values</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../computing/intrinsics/index.html">Intrinsic data types</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label for="toctree-checkbox-6"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../computing/intrinsics/gradual.html">Gradual representations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../computing/intrinsics/numbers.html">Numeric models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../computing/intrinsics/text.html">Textual models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../computing/intrinsics/logic.html">Logical models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../computing/intrinsics/functions.html">Program representations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../computing/intrinsics/collections.html">Collections</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../computing/application.html">Applying programs and commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="../computing/using.html">Using data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../computing/equality.html">Equality</a></li>
<li class="toctree-l3"><a class="reference internal" href="../computing/branching.html">Branching</a></li>
<li class="toctree-l3"><a class="reference internal" href="../computing/comprehension.html">Working with multiple values</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../effects/index.html">Effects</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label for="toctree-checkbox-7"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../effects/what-are-effects.html">What are effects?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../effects/handlers.html">Effect handlers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../effects/contexts.html">Contextual handlers</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../verification/index.html">Verification</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label for="toctree-checkbox-8"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../verification/examples.html">Example-based testing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../verification/contracts.html">Contracts</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../ffi/index.html">Foreign interfaces</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label for="toctree-checkbox-9"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../ffi/interface.html">Writing external functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ffi/ffi.html">The FFI type</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../security/index.html">Security and capabilities</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label for="toctree-checkbox-10"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../security/why.html">Why use capabilities?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/groups.html">Capabilities and groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/dynamic.html">Dynamic capabilities</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../design-philosophy.html">Annex A: Design philosophy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sociology-and-linguistics.html">Annex B: Sociology and linguistics</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/index.html">The Brief Syntax Cheatsheet</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label for="toctree-checkbox-11"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/declaration/index.html">Declarations</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label for="toctree-checkbox-12"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/declaration/capability.html"><code class="docutils literal notranslate"><span class="pre">capability</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/declaration/command.html"><code class="docutils literal notranslate"><span class="pre">command</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/declaration/define.html"><code class="docutils literal notranslate"><span class="pre">define</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/declaration/effect.html"><code class="docutils literal notranslate"><span class="pre">effect</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/declaration/implement.html"><code class="docutils literal notranslate"><span class="pre">implement</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/declaration/local.html"><code class="docutils literal notranslate"><span class="pre">local</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/declaration/open.html"><code class="docutils literal notranslate"><span class="pre">open</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/declaration/prelude.html"><code class="docutils literal notranslate"><span class="pre">prelude</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/declaration/protect.html"><code class="docutils literal notranslate"><span class="pre">protect</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/declaration/test.html"><code class="docutils literal notranslate"><span class="pre">test</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/declaration/trait.html"><code class="docutils literal notranslate"><span class="pre">trait</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/declaration/type.html"><code class="docutils literal notranslate"><span class="pre">type</span></code></a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/index.html">Expressions</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label for="toctree-checkbox-13"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/statement/index.html">Statements</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label for="toctree-checkbox-14"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/statement/assert.html"><code class="docutils literal notranslate"><span class="pre">assert</span></code> expression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/statement/let.html"><code class="docutils literal notranslate"><span class="pre">let</span></code> expression</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/index.html">Complex expressions</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label for="toctree-checkbox-15"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/apply.html">Program application</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/continue-with.html"><code class="docutils literal notranslate"><span class="pre">continue</span> <span class="pre">with</span></code> expression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/delayed.html">Delayed programs (Lambdas)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/do.html"><code class="docutils literal notranslate"><span class="pre">do</span> <span class="pre">..</span> <span class="pre">end</span></code> expression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/force.html"><code class="docutils literal notranslate"><span class="pre">force</span></code> expression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/foreign.html"><code class="docutils literal notranslate"><span class="pre">foreign</span></code> expression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/hole.html">Holes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/invocation.html">Command invocation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/perform.html"><code class="docutils literal notranslate"><span class="pre">perform</span></code> expression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/pipe.html">Pipe expressions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/projection.html">Projection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/return.html"><code class="docutils literal notranslate"><span class="pre">return</span></code> expression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/self-expr.html"><code class="docutils literal notranslate"><span class="pre">self</span></code> expression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/static-type.html">Static types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/variable.html">Variable references</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/atomic/index.html">Atomic expressions</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label for="toctree-checkbox-16"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/atomic/boolean.html">Boolean literals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/atomic/float.html">Floating point literals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/atomic/global.html">Global references</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/atomic/integer.html">Integer literals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/atomic/interpolate.html">Interpolation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/atomic/lazy.html"><code class="docutils literal notranslate"><span class="pre">lazy</span></code> expression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/atomic/list.html">List expression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/atomic/new.html"><code class="docutils literal notranslate"><span class="pre">new</span></code> expression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/atomic/nothing.html">Nothing literal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/atomic/record.html">Record expressions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/atomic/text.html">Text literals</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <main class="main">
    <div class="content">
      <article role="main">
        <label class="toc-overlay-icon toc-content-icon" for="__toc">
          <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
        </label>
        <div class="section" id="executing-commands">
<h1>Executing commands<a class="headerlink" href="#executing-commands" title="Permalink to this headline">¶</a></h1>
<p>We’ve seen that the same name might refer to several different commands,
and also briefly touched on how we can refer to a specific command. But
when we’re <em>using</em> commands, how exactly does Crochet decide which one
to pick and execute? In this section we’ll dive deep into the answer to
that question.</p>
<div class="section" id="selection-and-application">
<h2>Selection and application<a class="headerlink" href="#selection-and-application" title="Permalink to this headline">¶</a></h2>
<p>When we use a command in Crochet, we only refer to it by its name.
For example, in <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">+</span> <span class="pre">2</span></code> we’re only telling the system “hey, I want
to use the command <code class="docutils literal notranslate"><span class="pre">_</span> <span class="pre">+</span> <span class="pre">_</span></code> with these two values”. But we have no
way of specifying <em>which</em> of the <code class="docutils literal notranslate"><span class="pre">_</span> <span class="pre">+</span> <span class="pre">_</span></code> commands we’re talking about.</p>
<p>Many programming languages don’t have this problem, because a name
refers to exactly one entity—one function, one procedure, etc. Even
in Crochet, we don’t have this problem with types because a name
uniquely identifies a single type. If we say <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">is</span> <span class="pre">integer</span></code> in
Crochet, there’s only one type that can go by the name <code class="docutils literal notranslate"><span class="pre">integer</span></code>,
so the system immediately knows what we’re talking about.</p>
<p>So how does Crochet figure out which command we <em>mean</em>? Well, it doesn’t.
It does not have enough information to be able to figure out what you
wanted to happen. Instead, it does its best to approximate the most likely
meaning from the information available. And then execute the command.</p>
<p>This two-step process consists of <strong>selection</strong>—trying to figure out
which command best approximates your intention, given just a name and
some values. And <strong>application</strong>—the act of actually executing the
command. The combination of these two processes is called <strong>dispatch</strong>.</p>
</div>
<div class="section" id="the-selection-algorithm">
<h2>The selection algorithm<a class="headerlink" href="#the-selection-algorithm" title="Permalink to this headline">¶</a></h2>
<p>To make sure the approximation Crochet uses is more likely to match
your expectations, Crochet uses a well-defined algorithm for determining
which command to pick. This shared understanding of how selection works
does not mean that Crochet can’t do confusing things—rather, it means
that you’ll be able to understand why something confusing happened, and then
help Crochet pick the command that more accurately captures what you meant.</p>
<p>Crochet’s selection algorithm first picks some candidate commands, by
looking at which commands have their requirements fulfilled by the values
being used. Then it uses the idea of “closeness” to rank these commands.
It then picks up the single top-ranked command to execute.</p>
<p>But what’s “closeness”? Every value in Crochet is associated with a type.
And types, which commands use in their requirements, are organised in a
hierarchy. The closest commands are, then, the ones with the more specific
requirements.</p>
<p>Let’s see this in a less abstract way. Let’s say we’re describing plants
in Crochet—the way we <em>talk</em> about plants often suggests some hierarchy,
even if we don’t think about it that way. In Crochet, we could capture
this plant-hierarchy (or taxonomy) in the following way:</p>
<div class="highlight-crochet notranslate"><div class="highlight"><pre><span></span><span class="k">type</span> plant<span class="p">;</span>
<span class="k">type</span> flower <span class="k">is</span> plant<span class="p">;</span>
<span class="k">type</span> rose <span class="k">is</span> flower<span class="p">;</span>
<span class="k">type</span> white-rose <span class="k">is</span> rose<span class="p">;</span>
<span class="k">type</span> red-rose <span class="k">is</span> rose<span class="p">;</span>
</pre></div>
</div>
<p>So, from this declaration we know that a value such as <code class="docutils literal notranslate"><span class="pre">new</span> <span class="pre">red-rose</span></code> is
a red-rose. But it’s also, less specifically, a rose, a flower, and a plant.
And, of course, if we talk about <em>any</em> thing, sure we would be including red
roses!</p>
<p>Notice how we have some concept of which of these terms more closely (or more
specifically) describes the <code class="docutils literal notranslate"><span class="pre">new</span> <span class="pre">red-rose</span></code> value, and which ones less closely
do. Sure we can point at a red rose and say “this is a plant”. But that’s not
the most specific way we can refer to it, and a plant could be one of several
things. If we say: “plants may or may not have thorns” that’s not exactly
<em>useful</em> when we’re only thinking of red roses. “red roses have thorns” is
a more useful statement. It’s a <em>closer</em> statement, in Crochet’s sense.</p>
<p>So if we had commands that had requirements in this hierarchy, they could
look like this:</p>
<div class="highlight-crochet notranslate"><div class="highlight"><pre><span></span><span class="k">command</span> any has-thorns <span class="p">=</span> <span class="dl">"</span><span class="s2">that's a possibility</span><span class="dl">"</span><span class="p">;</span>
<span class="k">command</span> plant has-thorns <span class="p">=</span> <span class="dl">"</span><span class="s2">maybe</span><span class="dl">"</span><span class="p">;</span>
<span class="k">command</span> flower has-thorns <span class="p">=</span> <span class="dl">"</span><span class="s2">maybe</span><span class="dl">"</span><span class="p">;</span>
<span class="k">command</span> rose has-thorns <span class="p">=</span> <span class="dl">"</span><span class="s2">yes</span><span class="dl">"</span><span class="p">;</span>
<span class="k">command</span> white-rose has-thorns <span class="p">=</span> <span class="dl">"</span><span class="s2">definitely</span><span class="dl">"</span><span class="p">;</span>
<span class="k">command</span> red-rose has-thorns <span class="p">=</span> <span class="dl">"</span><span class="s2">you bet</span><span class="dl">"</span><span class="p">;</span>
</pre></div>
</div>
<p>And if we were to use this <code class="docutils literal notranslate"><span class="pre">_</span> <span class="pre">has-thorns</span></code> command with our red rose,
that is, if we had <code class="docutils literal notranslate"><span class="pre">(new</span> <span class="pre">red-rose)</span> <span class="pre">has-thorns</span></code> somewhere in our code,
then Crochet’s selection algorithm would first filter these commands.
In this case, we filter out the <code class="docutils literal notranslate"><span class="pre">white-rose</span> <span class="pre">has-thorns</span></code> command—because
a red rose can never be a white rose, given the hierarchy we’ve described.</p>
<p>Everything else is still a candidate for being executed, however, so
Crochet proceeds to rank these commands in the following way:</p>
<div class="highlight-crochet notranslate"><div class="highlight"><pre><span></span><span class="mf">1</span><span class="p">.</span>   red-rose has-thorns
<span class="mf">2</span><span class="p">.</span>   rose has-thorns
<span class="mf">3</span><span class="p">.</span>   flower has-thorns
<span class="mf">4</span><span class="p">.</span>   plant has-thorns
<span class="mf">5</span><span class="p">.</span>   any has-thorns
</pre></div>
</div>
<p>We’ve got one command at the very top—ranked in the 1st position:
<code class="docutils literal notranslate"><span class="pre">red-rose</span> <span class="pre">has-thorns</span></code>. This what Crochet considers the closest command
that matches what we likely meant by <code class="docutils literal notranslate"><span class="pre">(new</span> <span class="pre">red-rose)</span> <span class="pre">has-thorns</span></code>, so
that’s the one it will pick.</p>
<div class="section" id="ranking-trait-requirements">
<h3>Ranking trait requirements<a class="headerlink" href="#ranking-trait-requirements" title="Permalink to this headline">¶</a></h3>
<p>In addition to type requirements, commands in Crochet may also have
trait requirements. Unlike types, traits in Crochet are not arranged
into any hierarchy, so the idea of closeness that we’ve previously
discussed doesn’t really apply to traits. Even worse: traits can be
implemented by multiple types and it isn’t obvious how to think about
which of these implementations and requirements should be considered
“closer”.</p>
<p>A trait requirement has the form of <code class="docutils literal notranslate"><span class="pre">Variable</span> <span class="pre">is</span> <span class="pre">type</span> <span class="pre">has</span> <span class="pre">trait,</span> <span class="pre">...</span></code>,
so we still apply the same ranking for type hierarchies that we’ve seen
before for the <code class="docutils literal notranslate"><span class="pre">is</span> <span class="pre">type</span></code> part. For the trait part, however, Crochet
assumes that none of them is closer than any other of them. They all
have the same weight, the same specificity, the same closeness.</p>
<p>However, Crochet does define that a requirement that includes traits
is a tiny bit closer than a requirement that does not include traits,
if both of them share the same type requirement. For example:</p>
<div class="highlight-crochet notranslate"><div class="highlight"><pre><span></span><span class="k">command</span> <span class="p">(</span><span class="nv">X</span> <span class="k">is</span> red-rose<span class="p">)</span> smell <span class="p">=</span> <span class="dl">"</span><span class="s2">It smells quite nice!</span><span class="dl">"</span><span class="p">;</span>
<span class="k">command</span> <span class="p">(</span><span class="nv">X</span> <span class="k">is</span> flower <span class="k">has</span> perfume<span class="p">)</span> smell <span class="p">=</span> <span class="dl">"</span><span class="s2">It smells nice</span><span class="dl">"</span><span class="p">;</span>
<span class="k">command</span> <span class="p">(</span><span class="nv">X</span> <span class="k">is</span> flower<span class="p">)</span> smell <span class="p">=</span> <span class="dl">"</span><span class="s2">You can't really tell much</span><span class="dl">"</span><span class="p">;</span>
</pre></div>
</div>
<p>Here, if we were to rank these commands we’d end up with:</p>
<div class="highlight-crochet notranslate"><div class="highlight"><pre><span></span><span class="mf">1</span><span class="p">.</span>  <span class="p">(</span><span class="nv">X</span> <span class="k">is</span> red-rose<span class="p">)</span> smell
<span class="mf">2</span><span class="p">.</span>  <span class="p">(</span><span class="nv">X</span> <span class="k">is</span> flower <span class="k">has</span> perfume<span class="p">)</span> smell
<span class="mf">3</span><span class="p">.</span>  <span class="p">(</span><span class="nv">X</span> <span class="k">is</span> flower<span class="p">)</span> smell
</pre></div>
</div>
<p>Note how, despite being pretty much the same type requirement, the <code class="docutils literal notranslate"><span class="pre">_</span> <span class="pre">smell</span></code>
command with a trait requirement ranks slightly higher than the one without.</p>
<p>The number of traits in a trait requirement, or the specific traits that
figure in it do not affect the ranking. Crochet only cares if a requirement
includes traits or not.</p>
</div>
<div class="section" id="selection-with-multiple-requirements">
<h3>Selection with multiple requirements<a class="headerlink" href="#selection-with-multiple-requirements" title="Permalink to this headline">¶</a></h3>
<p>We’ve seen how commands can be ranked when we have just one requirement.
But things get a bit more complicated when we have multiple requirements.
For example, consider what happens if we extend our collection of rose
commands to consider multiple of them at the same time:</p>
<div class="highlight-crochet notranslate"><div class="highlight"><pre><span></span><span class="k">command</span> <span class="nf">combine:</span> rose <span class="nf">and:</span> flower <span class="p">=</span> <span class="dl">"</span><span class="s2">A</span><span class="dl">"</span><span class="p">;</span>
<span class="k">command</span> <span class="nf">combine:</span> flower <span class="nf">and:</span> rose <span class="p">=</span> <span class="dl">"</span><span class="s2">B</span><span class="dl">"</span><span class="p">;</span>
</pre></div>
</div>
<p>Intuitivelly, we’d expect these commands to have the same requirements.
They both require one rose and one flower on each side. So, if we were
to use this command like so:</p>
<div class="highlight-crochet notranslate"><div class="highlight"><pre><span></span><span class="nf">combine:</span> <span class="k">new</span> red-rose <span class="nf">and:</span> <span class="k">new</span> white-rose<span class="p">;</span>
</pre></div>
</div>
<p>Which one of the commands would be selected? What would we get back
from it? In Crochet, the answer would be <code class="docutils literal notranslate"><span class="pre">"A"</span></code>. That’s because
Crochet considers the left-most requirements (the first one in this case)
to have more weight than the right-most requirements (the second one in this case).</p>
<p>So when making a decision to rank these commands, Crochet first looks at
the first requirement of each command and picks the closest one. Then, if
there are still multiple commands that can be selected, it looks at the
second requirement of each command to pick the closest one again. And it
keeps doing so until it runs out of requirements, or only one top ranked
command remains.</p>
<p>So we’d rank the commands above like this:</p>
<div class="highlight-crochet notranslate"><div class="highlight"><pre><span></span><span class="mf">1</span><span class="p">.</span>  <span class="nf">combine:</span> rose <span class="nf">and:</span> flower
<span class="mf">2</span><span class="p">.</span>  <span class="nf">combine:</span> flower <span class="nf">and:</span> rose
</pre></div>
</div>
</div>
<div class="section" id="ambiguities-in-selection">
<h3>Ambiguities in selection<a class="headerlink" href="#ambiguities-in-selection" title="Permalink to this headline">¶</a></h3>
<p>Sometimes selections are “too successful”. That is, with all the information
that Crochet has, it isn’t able to pick just one top ranked command—it is
left with several top ranked ones. In these cases Crochet simply cannot
proceed on its own and needs some manual intervention.</p>
<p>But how do these kinds of ambiguity rise? There are three common cases:</p>
<ul>
<li><p><strong>Uncoordinated definition of commands</strong>: commands can be defined anywhere,
by anyone, for any type. So it might be the case that you’ve defined a
command for some type with a name, and someone else independently defined
another command for the same type, with the same name.</p>
<p>Here, you need to pick which of the commands the application will use.</p>
</li>
<li><p><strong>Coding mistakes</strong>: because commands can be defined anywhere, one might
forget that they had already defined a command for some type and try to
define it again somewhere else.</p>
<p>Here, you might want to remove one of the command definitions. Or, if
they’re both supposed to exist, you can rename one of them.</p>
</li>
<li><p><strong>The use of traits</strong>: because traits don’t have a hierarchy, they’re
particularly prone to ambiguities. In these cases you can try to make
the requirement more specific or rename the command.</p></li>
</ul>
</div>
<div class="section" id="what-if-no-command-is-selected">
<h3>What if no command is selected?<a class="headerlink" href="#what-if-no-command-is-selected" title="Permalink to this headline">¶</a></h3>
<p>Sometimes the selection might not be successful at all—there are no commands
whose requirements are fulfilled by the used values. Again, Crochet can’t
really do much here on its own and will need manual intervention.</p>
<p>There are three common cases where this failure happens:</p>
<ul>
<li><p><strong>Mistyping the command</strong>: it’s easy to have a typo in the command name
and not notice it. Sometimes these typos can mean that you get a command
that exists, but wasn’t the one you wanted.</p>
<p>In either case, the way to address this is to fix the typo.</p>
</li>
<li><p><strong>High requirements</strong>: it can be that, when you started writing the
program, you had some view of the requirements in mind, but as you’ve
iterated in your design you started relaxing those requirements—but
didn’t get to update them in all of the places.</p>
<p>In this case you might want to update the requirements in those
commands.</p>
</li>
<li><p><strong>Missing commands</strong>: sometimes you might approach writing a program
through a more wishful approach—you use commands before you actually
define them; and you only define commands when you’re happy with how
using them feels like. It’s easy to forget to define the command later,
and get this error when trying to run the program.</p>
<p>Another case where this can happen is if you’re using a package written
by someone else, and you try to provide values to a command that the
package author had not considered when designing it.</p>
<p>In both of these cases the only action you can do is define the missing
commands.</p>
</li>
</ul>
</div>
</div>
<div class="section" id="applying-commands">
<h2>Applying commands<a class="headerlink" href="#applying-commands" title="Permalink to this headline">¶</a></h2>
<p>We’ve selected one top ranked command, so Crochet can proceed to applying
that command—executing its behaviour. Application of commands in Crochet
is largely similar to how it happens in other programming languages: we
allow the names described in the command’s signature to refer to the
values we’ve used in that position, and then we execute the command’s
body.</p>
<p>That is, consider the following command:</p>
<div class="highlight-crochet notranslate"><div class="highlight"><pre><span></span><span class="k">type</span> person<span class="p">;</span>
<span class="k">type</span> alice <span class="k">is</span> person<span class="p">;</span>

<span class="k">enum</span> food <span class="p">=</span> bread<span class="p">,</span> cake<span class="p">,</span> crepe<span class="p">;</span>

<span class="k">command</span> <span class="p">(</span><span class="nv">Who</span> <span class="k">is</span> person<span class="p">)</span> <span class="nf">likes:</span> <span class="p">(</span><span class="nv">What</span> <span class="k">is</span> food<span class="p">)</span> <span class="p">=</span>
  <span class="dl">"</span><span class="si">[</span><span class="nv">Who</span><span class="si">]</span><span class="s2"> likes </span><span class="si">[</span><span class="nv">What</span><span class="si">]</span><span class="s2">!</span><span class="dl">"</span><span class="p">;</span>
</pre></div>
</div>
<p>If we use this command like so:</p>
<div class="highlight-crochet notranslate"><div class="highlight"><pre><span></span>alice <span class="nf">likes:</span> cake<span class="p">;</span>
</pre></div>
</div>
<p>Then, inside of that command’s body, the variable <code class="docutils literal notranslate"><span class="pre">Who</span></code> will refer to the
value <code class="docutils literal notranslate"><span class="pre">alice</span></code>, the the variable <code class="docutils literal notranslate"><span class="pre">What</span></code> will refer to the value <code class="docutils literal notranslate"><span class="pre">cake</span></code>.
The names refer to the values that appear in the same position when we use
the method. This means that, as an output, we’ll get <code class="docutils literal notranslate"><span class="pre">"alice</span> <span class="pre">likes</span> <span class="pre">cake!"</span></code></p>
<p>More specifically, we call the names in the signature, like <code class="docutils literal notranslate"><span class="pre">Who</span></code> and <code class="docutils literal notranslate"><span class="pre">What</span></code>,
parameters. The values that appear when we use the command, like <code class="docutils literal notranslate"><span class="pre">alice</span></code> and
<code class="docutils literal notranslate"><span class="pre">cake</span></code> here, are called arguments.</p>
<div class="section" id="the-self-name">
<h3>The <code class="docutils literal notranslate"><span class="pre">self</span></code> name<a class="headerlink" href="#the-self-name" title="Permalink to this headline">¶</a></h3>
<p>In Crochet, there exists one very special name called <code class="docutils literal notranslate"><span class="pre">self</span></code>. This name
will always refer to the left-most argument in an application, as long as
this argument appears before any portion of the command’s name.</p>
<p>That is, in <code class="docutils literal notranslate"><span class="pre">_</span> <span class="pre">some-command</span></code>, <code class="docutils literal notranslate"><span class="pre">_</span> <span class="pre">+</span> <span class="pre">_</span></code>, and <code class="docutils literal notranslate"><span class="pre">_</span> <span class="pre">some:</span> <span class="pre">_</span> <span class="pre">keyword:</span> <span class="pre">_</span></code>,
the argument in the position of the first underscore can also be referred
to by the special name <code class="docutils literal notranslate"><span class="pre">self</span></code>. But this isn’t true for the command
<code class="docutils literal notranslate"><span class="pre">some:</span> <span class="pre">_</span> <span class="pre">keyword:</span> <span class="pre">_</span></code>, because the first underscore here appears after
a portion of the command’s name.</p>
<p>Using self, both of the following commands have equivalent behaviour:</p>
<div class="highlight-crochet notranslate"><div class="highlight"><pre><span></span><span class="k">command</span> alice greet <span class="p">=</span> <span class="dl">"</span><span class="si">[</span><span class="k">self</span><span class="si">]</span><span class="s2"> says, 'Hello!'</span><span class="dl">"</span><span class="p">;</span>

<span class="k">command</span> <span class="p">(</span><span class="nv">Who</span> <span class="k">is</span> alice<span class="p">)</span> greet <span class="p">=</span> <span class="dl">"</span><span class="si">[</span><span class="nv">Who</span><span class="si">]</span><span class="s2"> says, 'Hello!'</span><span class="dl">"</span><span class="p">;</span>
</pre></div>
</div>
<p>You might have stumbled with the concept of <code class="docutils literal notranslate"><span class="pre">self</span></code> in other languages
by different names. It’s often called “the receiver parameter”. Sometimes
it’s also called by the more confusing term “the method context”. Some
languages use <code class="docutils literal notranslate"><span class="pre">me</span></code> or <code class="docutils literal notranslate"><span class="pre">this</span></code> for this same concept. Ultimately, in
Crochet, <code class="docutils literal notranslate"><span class="pre">self</span></code> is just a convenience that relieves you from naming
the first parameter explicitly.</p>
</div>
</div>
</div>

      </article>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="why.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Why are commands …?</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="signatures.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Signatures and their uses</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; 2021, Q.
            |
            Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
              and
              <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
              <a href="https://github.com/pradyunsg/furo">Furo theme</a>.
            |
            <a class="muted-link" href="../../_sources/system/commands/dispatch.rst.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Executing commands</a><ul>
<li><a class="reference internal" href="#selection-and-application">Selection and application</a></li>
<li><a class="reference internal" href="#the-selection-algorithm">The selection algorithm</a><ul>
<li><a class="reference internal" href="#ranking-trait-requirements">Ranking trait requirements</a></li>
<li><a class="reference internal" href="#selection-with-multiple-requirements">Selection with multiple requirements</a></li>
<li><a class="reference internal" href="#ambiguities-in-selection">Ambiguities in selection</a></li>
<li><a class="reference internal" href="#what-if-no-command-is-selected">What if no command is selected?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#applying-commands">Applying commands</a><ul>
<li><a class="reference internal" href="#the-self-name">The <code class="docutils literal notranslate"><span class="pre">self</span></code> name</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </main>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/scripts/main.js"></script>
    </body>
</html>