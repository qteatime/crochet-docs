<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Dynamic capabilities" href="dynamic.html" /><link rel="prev" title="Why use capabilities?" href="why.html" />

    <meta name="generator" content="sphinx-4.1.1, furo 2021.07.05.beta38"/>
        <title>Capabilities and groups - Crochet 0.12 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/crochet.css" />
    


<style>
  :root {
    --color-code-background: #ffffff;
  --color-code-foreground: black;
  
  }
  @media (prefers-color-scheme: dark) {
    :root {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }

  /* For allowing end-user-specific overrides */
  .override-light {
    --color-code-background: #ffffff;
  --color-code-foreground: black;
  
  }
  .override-dark {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
</style><link media="(prefers-color-scheme: dark)" rel="stylesheet" href="../../_static/pygments_dark.css"></head>
  <body dir="">
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke-width="1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z"/>
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
      class="feather feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
      class="feather feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Crochet 0.12 documentation</div></a>
    </div>
    <div class="header-right">
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">Crochet 0.12 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html">
  <input class="sidebar-search" placeholder=Search name="q">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">The Crochet System</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label for="toctree-checkbox-1"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../whats-crochet.html">What’s Crochet?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installing-crochet.html">Installing Crochet</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../structure/index.html">How is Crochet structured?</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label for="toctree-checkbox-2"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../structure/introduction.html">The Crochet universe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../structure/package-configuration.html">Package configuration</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../types/index.html">Data and types</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label for="toctree-checkbox-3"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../types/types-and-data.html">Types and data modelling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../types/hierarchies.html">Hierarchies of types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../types/traits.html">Traits</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../commands/index.html">Commands</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label for="toctree-checkbox-4"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../commands/declaration.html">What are commands?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/signatures.html">Signatures and their uses</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/dispatch.html">Executing commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/why.html">Why are commands …?</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../computing/index.html">Computing with Crochet</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label for="toctree-checkbox-5"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../computing/execution-models.html">Execution models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../computing/bindings.html">Naming values</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../computing/intrinsics/index.html">Intrinsic data types</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label for="toctree-checkbox-6"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../computing/intrinsics/gradual.html">Gradual representations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../computing/intrinsics/numbers.html">Numeric models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../computing/intrinsics/text.html">Textual models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../computing/intrinsics/logic.html">Logical models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../computing/intrinsics/functions.html">Program representations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../computing/intrinsics/collections.html">Collections</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../computing/application.html">Applying programs and commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="../computing/using.html">Using data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../computing/equality.html">Equality</a></li>
<li class="toctree-l3"><a class="reference internal" href="../computing/branching.html">Branching</a></li>
<li class="toctree-l3"><a class="reference internal" href="../computing/comprehension.html">Working with multiple values</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../effects/index.html">Effects</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label for="toctree-checkbox-7"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../effects/what-are-effects.html">What are effects?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../effects/handlers.html">Effect handlers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../effects/contexts.html">Contextual handlers</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../verification/index.html">Verification</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label for="toctree-checkbox-8"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../verification/examples.html">Example-based testing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../verification/contracts.html">Contracts</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../ffi/index.html">Foreign interfaces</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label for="toctree-checkbox-9"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../ffi/interface.html">Writing external functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ffi/ffi.html">The FFI type</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">Security and capabilities</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label for="toctree-checkbox-10"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="why.html">Why use capabilities?</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Capabilities and groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamic.html">Dynamic capabilities</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../design-philosophy.html">Annex A: Design philosophy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sociology-and-linguistics.html">Annex B: Sociology and linguistics</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/index.html">The Brief Syntax Cheatsheet</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label for="toctree-checkbox-11"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/declaration/index.html">Declarations</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label for="toctree-checkbox-12"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/declaration/capability.html"><code class="docutils literal notranslate"><span class="pre">capability</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/declaration/command.html"><code class="docutils literal notranslate"><span class="pre">command</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/declaration/define.html"><code class="docutils literal notranslate"><span class="pre">define</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/declaration/effect.html"><code class="docutils literal notranslate"><span class="pre">effect</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/declaration/implement.html"><code class="docutils literal notranslate"><span class="pre">implement</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/declaration/local.html"><code class="docutils literal notranslate"><span class="pre">local</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/declaration/open.html"><code class="docutils literal notranslate"><span class="pre">open</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/declaration/prelude.html"><code class="docutils literal notranslate"><span class="pre">prelude</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/declaration/protect.html"><code class="docutils literal notranslate"><span class="pre">protect</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/declaration/test.html"><code class="docutils literal notranslate"><span class="pre">test</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/declaration/trait.html"><code class="docutils literal notranslate"><span class="pre">trait</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/declaration/type.html"><code class="docutils literal notranslate"><span class="pre">type</span></code></a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/index.html">Expressions</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label for="toctree-checkbox-13"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/statement/index.html">Statements</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label for="toctree-checkbox-14"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/statement/assert.html"><code class="docutils literal notranslate"><span class="pre">assert</span></code> expression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/statement/let.html"><code class="docutils literal notranslate"><span class="pre">let</span></code> expression</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/index.html">Complex expressions</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label for="toctree-checkbox-15"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/apply.html">Program application</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/continue-with.html"><code class="docutils literal notranslate"><span class="pre">continue</span> <span class="pre">with</span></code> expression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/delayed.html">Delayed programs (Lambdas)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/do.html"><code class="docutils literal notranslate"><span class="pre">do</span> <span class="pre">..</span> <span class="pre">end</span></code> expression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/force.html"><code class="docutils literal notranslate"><span class="pre">force</span></code> expression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/foreign.html"><code class="docutils literal notranslate"><span class="pre">foreign</span></code> expression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/hole.html">Holes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/invocation.html">Command invocation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/perform.html"><code class="docutils literal notranslate"><span class="pre">perform</span></code> expression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/pipe.html">Pipe expressions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/projection.html">Projection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/return.html"><code class="docutils literal notranslate"><span class="pre">return</span></code> expression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/self-expr.html"><code class="docutils literal notranslate"><span class="pre">self</span></code> expression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/static-type.html">Static types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/complex/variable.html">Variable references</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/atomic/index.html">Atomic expressions</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label for="toctree-checkbox-16"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/atomic/boolean.html">Boolean literals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/atomic/float.html">Floating point literals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/atomic/global.html">Global references</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/atomic/integer.html">Integer literals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/atomic/interpolate.html">Interpolation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/atomic/lazy.html"><code class="docutils literal notranslate"><span class="pre">lazy</span></code> expression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/atomic/list.html">List expression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/atomic/new.html"><code class="docutils literal notranslate"><span class="pre">new</span></code> expression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/atomic/nothing.html">Nothing literal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/atomic/record.html">Record expressions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cookbook-and-cheatsheet/brief-syntax/expression/atomic/text.html">Text literals</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <main class="main">
    <div class="content">
      <article role="main">
        <label class="toc-overlay-icon toc-content-icon" for="__toc">
          <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
        </label>
        <div class="section" id="capabilities-and-groups">
<h1>Capabilities and groups<a class="headerlink" href="#capabilities-and-groups" title="Permalink to this headline">¶</a></h1>
<p>Capabilities are little unforgeable keys that can be given to some
piece of code to enable it to perform something specific. In this
section we dive into details of how these little keys work in Crochet.</p>
<div class="section" id="primordial-capabilities">
<h2>Primordial capabilities<a class="headerlink" href="#primordial-capabilities" title="Permalink to this headline">¶</a></h2>
<p>Just like mobile phones have a set of capabilities of themselves that can be
given to any application—like “camera access”—, Crochet has a set of
capabilities of itself that can be given to any package. Crochet calls them
“primordial capabilities”—because they exist for as long as Crochet itself
exists, even if no packages were to be brought into existence.</p>
<p>There is currently only one primordial capability in Crochet:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">native</span></code>: a package with the <code class="docutils literal notranslate"><span class="pre">native</span></code> capability is allowed to
define modules using the Foreign Interface. Such modules cannot be
properly contained by Crochet, and thus threaten all of the security
guarantees that Crochet aims to provide; but, sometimes, they’re necessary.
This is why Crochet allows one to give permission to a package to do
such dangerous thing, by granting it the <code class="docutils literal notranslate"><span class="pre">native</span></code> capability.</p></li>
</ul>
</div>
<div class="section" id="types-as-capabilities">
<h2>Types as capabilities<a class="headerlink" href="#types-as-capabilities" title="Permalink to this headline">¶</a></h2>
<p>In Crochet, types also play the role of capabilities. This is a bit different
from how capability security appears in other programming languages, but
it supports Crochet’s idea of supporting people to reason about what
kind of risks they’re taking, and who they’re taking risks with.</p>
<p>A type is an unique, unforgeable name. The powers a type grants are
access to the commands which have them as requirements. This allows
us to think about risks both in the higher-level sense of the type
itself, and in the more fine-grained sense of individual commands.</p>
<p>In order to make sure that people are only taking the risks
they’re comfortable with, Crochet needs to make sure that these
types are only known by some pieces of code. This is achieved by
restricting types to their declaring package.</p>
<div class="section" id="granting-type-capabilities">
<h3>Granting type capabilities<a class="headerlink" href="#granting-type-capabilities" title="Permalink to this headline">¶</a></h3>
<p>If package A declares a type <code class="docutils literal notranslate"><span class="pre">some-power</span></code>, then only package A has
access to it initially. No other package can have A’s <code class="docutils literal notranslate"><span class="pre">some-power</span></code>—no
other package can get that specific power. This is the “unforgeable” guarantee.
It’s not enough to <em>know</em> the name of a type—you need to be given
access to it in order to use it.</p>
<p>For example, if capabilities were keys that can open very specific locks,
then it wouldn’t be enough to just know what the key looks like—its colour,
shape, size. You would need to get your hands into the physical key in order
to open those locks.</p>
<p>This process is what Crochet refers to as “capability grants”. Crochet itself
manages this “granting” part—the act of getting the “physical” keys into
the hands of specific pieces of code. And the default process of granting
capabilities is that the package which has declared a type has a grant to
use that type—but no other package will have the same grant.</p>
<p>Still, in order for packages to cooperate, sometimes we need to share these
keys with others. One way to do this is through package dependencies. A
package may request access to the types of another package by declaring
that it depends on it in order to work.</p>
<p>For example, the following Package configuration would request access to
the types of package <code class="docutils literal notranslate"><span class="pre">crochet.random</span></code>:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"my-package"</span><span class="p">,</span>
  <span class="nt">"dependencies"</span><span class="p">:</span> <span class="p">[</span>
    <span class="s2">"crochet.random"</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This allows <code class="docutils literal notranslate"><span class="pre">my-package</span></code> to use types such as <code class="docutils literal notranslate"><span class="pre">crochet.random/random</span></code>,
either by referring to it through its full name, or by opening the package
first:</p>
<div class="highlight-crochet notranslate"><div class="highlight"><pre><span></span><span class="k">open</span> crochet.random<span class="p">;</span>

<span class="c1">// Then later</span>
<span class="k">let</span> <span class="nv">Random</span> <span class="p">=</span> <span class="o">#</span>random <span class="nf">with-seed:</span> <span class="mf">123456789</span><span class="p">;</span>
</pre></div>
</div>
<p>But if what if we had a different package, <code class="docutils literal notranslate"><span class="pre">other-package</span></code>, which did
<em>not</em> have a dependency on <code class="docutils literal notranslate"><span class="pre">crochet.random</span></code> in its package configuration?
Surely it knows what the full name of the <code class="docutils literal notranslate"><span class="pre">random</span></code> type is, so it could
try to have code that looks like this:</p>
<div class="highlight-crochet notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="nv">Random</span> <span class="p">=</span> <span class="o">#</span>crochet.random<span class="o">/</span>random <span class="nf">with-seed:</span> <span class="mf">123456789</span><span class="p">;</span>
</pre></div>
</div>
<p>But if we run this, we’ll get the following error message from Crochet’s
security policy:</p>
<blockquote>
<div><p><strong>lacking-capability</strong>: Accessing type random cannot be done
in module <code class="docutils literal notranslate"><span class="pre">test</span></code> in <code class="docutils literal notranslate"><span class="pre">other-package</span></code> because the package
does not have the following required capabilities:
a dependency on <code class="docutils literal notranslate"><span class="pre">crochet.random</span></code>.</p>
</div></blockquote>
</div>
</div>
<div class="section" id="capability-groups">
<h2>Capability groups<a class="headerlink" href="#capability-groups" title="Permalink to this headline">¶</a></h2>
<p>If primordial capabilities are those defined by Crochet itself, then
capability groups are the similar concept for things package developers
come up with—capabilities that are defined by the package itself.</p>
<p>A capability group is a way of declaring a dangerous power, and also
what exactly are the risks that this power carries—what Crochet should
make sure to not let users access without understanding and consenting
to these risks.</p>
<p>A group is introduced with the <code class="docutils literal notranslate"><span class="pre">capability</span></code> declaration:</p>
<div class="highlight-crochet notranslate"><div class="highlight"><pre><span></span><span class="k">capability</span> too-powerful<span class="p">;</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">my-package</span></code> has the declaration above, then we would let Crochet
know that a capability <code class="docutils literal notranslate"><span class="pre">my-package/too-powerful</span></code> exists. But just
declaring a capability is not entirely meaningful, we also need to
declare what exactly this capability means—what Crochet must protect
with this capability. That’s done through the <code class="docutils literal notranslate"><span class="pre">protect</span></code> declaration.</p>
<p>For example, if this package were to define the type <code class="docutils literal notranslate"><span class="pre">game-state</span></code>,
which allows one to create, load, and delete save files, it might
want to tell Crochet that such type is powerful:</p>
<div class="highlight-crochet notranslate"><div class="highlight"><pre><span></span><span class="k">type</span> game-state<span class="p">;</span>

<span class="k">protect</span> <span class="k">type</span> game-state <span class="k">with</span> too-powerful<span class="p">;</span>
</pre></div>
</div>
<p>Additionally, the <code class="docutils literal notranslate"><span class="pre">protect</span> <span class="pre">effect</span></code> and <code class="docutils literal notranslate"><span class="pre">protect</span> <span class="pre">global</span></code> forms
of this declaration exist for Effects and Global Bindings respectively.</p>
<p>Finally, if a package wants to share this capability with others,
it must tell Crochet so in its package configuration:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"my-package"</span><span class="p">,</span>
  <span class="nt">"modules"</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">"capabilities"</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">"requires"</span><span class="p">:</span> <span class="p">[],</span>
    <span class="nt">"provides"</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"too-powerful"</span><span class="p">,</span>
        <span class="nt">"description"</span><span class="p">:</span> <span class="s2">"Allows creating, loading, and deleting save data."</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Capability groups can be entirely internal, too! In that case, the capability
group is used to tell Crochet that a set of types, effects, and global bindings
are too powerful, and no other package will ever be able to access them. That
power is then entirely restricted to its defining package.</p>
</div>
<div class="section" id="propagating-capabilities">
<h2>Propagating capabilities<a class="headerlink" href="#propagating-capabilities" title="Permalink to this headline">¶</a></h2>
<p>So, if capabilities are like physical keys that we can give to pieces
of code to allow them to do things, <em>who</em> is out there giving out these
keys?</p>
<p>Well, everyone is. Yes, everyone. Not just Crochet. And that’s what makes
this process a bit complicated. In order to make this process safe, Crochet
needs to supervise it.</p>
<p>The process of granting—and propagating—capabilities involves a few
concepts:</p>
<ul class="simple">
<li><p>The capabilities are <strong>unforgeable</strong>. That is, in order to use a
capability—in order to use this key—you need to be given the key
by someone. You cannot just <em>materialise</em> a key out of thin air with
wishes and knowledge alone.</p></li>
<li><p>You can <strong>choose to share</strong> a capability that you’re given with
another package that you trust. This package is then one of your
dependencies. But you have to <em>actively</em> choose it. By default
Crochet does not share any capabilities with anyone.</p></li>
<li><p>Once you share a capability, you cannot go back on your word. Capabilities
are <strong>irrevocable</strong>, when shared in this manner. But that’s only because
we want to be able to <em>think</em> about what exactly we’re trusting. Crochet
allows a different way of granting capabilities that allows us to take
back the key, which we’ll cover in the next chapter.</p></li>
</ul>
<p>In terms of how this all works in practice, a package must declare in
its <code class="docutils literal notranslate"><span class="pre">required</span></code> capabilities any key that it needs in order to work.
And in its dependencies, it must <em>provide</em> any capability that it wishes
to share. For example, consider the following package configuration:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"my-game"</span><span class="p">,</span>
  <span class="nt">"dependencies"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"save-data"</span><span class="p">,</span>
      <span class="nt">"capabilities"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"simple-save-data/save-data"</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"crochet.random"</span><span class="p">,</span>
      <span class="nt">"capabilities"</span><span class="p">:</span> <span class="p">[]</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="nt">"capabilities"</span><span class="p">:</span> <span class="p">[</span>
    <span class="nt">"requires"</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">"crochet.random/read-shared-instance"</span><span class="p">,</span>
      <span class="s2">"simple-save-data/save-data"</span>
    <span class="p">],</span>
    <span class="nt">"provides"</span><span class="p">:</span> <span class="p">[]</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here, the <code class="docutils literal notranslate"><span class="pre">my-game</span></code> package needs to be provided with the
<code class="docutils literal notranslate"><span class="pre">crochet.random/read-shared-instance</span></code> and <code class="docutils literal notranslate"><span class="pre">simple-save-data/save-data</span></code>
capabilities in order to work. Once it’s loaded—and given those keys—it
then proceeds to load the <code class="docutils literal notranslate"><span class="pre">save-data</span></code> package. Now it has two keys that
it could share, but it only chooses to share the <code class="docutils literal notranslate"><span class="pre">simple-save-data/save-data</span></code>
key.</p>
<p><em>Even if</em> the <code class="docutils literal notranslate"><span class="pre">save-data</span></code> package chooses to, later on, use the
<code class="docutils literal notranslate"><span class="pre">crochet.random/read-shared-instance</span></code> capability, it cannot do so because
<code class="docutils literal notranslate"><span class="pre">my-game</span></code> chose to not share that key. This is how we can be absolutely
certain that <code class="docutils literal notranslate"><span class="pre">save-data</span></code> will never be able to do anything that isn’t
interacting with save data. It will never be able to interfere with the
random number generator that is used by <code class="docutils literal notranslate"><span class="pre">my-game</span></code> because it simply
does not have that key. It can’t get access to the types and bindings
it would need to do so.</p>
<p>But how does <code class="docutils literal notranslate"><span class="pre">my-game</span></code> gets its hands on those keys anyway? Well, if
<code class="docutils literal notranslate"><span class="pre">my-game</span></code> is loaded as the dependency of another package, it’s up to
that package to give <code class="docutils literal notranslate"><span class="pre">my-game</span></code> the capabilities it needs. But at some
point, someone really needs to “fabricate” these keys—at the top level,
that “someone” is Crochet. When a user runs a Crochet application—which
is really a Crochet package—it’ll be asked to share with the application
all of the capabilities it needs, and if the user agrees to do so, Crochet
will fabricate those keys and pass it on to the application. The application
can then choose to share as many or as few keys as it wants, depending on
its needs and on how much it trusts its dependencies.</p>
<div class="section" id="a-note-on-cycles">
<h3>A note on cycles<a class="headerlink" href="#a-note-on-cycles" title="Permalink to this headline">¶</a></h3>
<p>When we put all of these dependencies together, Crochet expects them
to form a tree—or, rather, an acyclic graph. That is, a package
cannot depend on something that will eventually contain itself as
a dependency. Crochet would never be able to figure out who’s
granting powers to who in that case.</p>
<p>For example, consider the following dependencies:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alice</span></code> depends on <code class="docutils literal notranslate"><span class="pre">bob</span></code> and <code class="docutils literal notranslate"><span class="pre">teresa</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bob</span></code> depends on <code class="docutils literal notranslate"><span class="pre">clara</span></code> and <code class="docutils literal notranslate"><span class="pre">kim</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kim</span></code> depends on <code class="docutils literal notranslate"><span class="pre">teresa</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">clara</span></code> and <code class="docutils literal notranslate"><span class="pre">teresa</span></code> do not depend on anyone.</p></li>
</ul>
<p>We could visualise this as the following:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>alice
  |
  |
  `---+------------,
      |            |
      V            V
     bob         teresa &lt;-----,
      |                       |
      |                       |
      `---+--------,          |
          |        |          |
          V        V          |
        clara     kim         |
                   |          |
                   |          |
                   `----------'
</pre></div>
</div>
<p>Note how, if we follow the arrows in this graph, regardless of the path
we take, if we see one of these packages once, we will not see it again.
That is, we can take the path <code class="docutils literal notranslate"><span class="pre">alice</span> <span class="pre">-&gt;</span> <span class="pre">bob</span> <span class="pre">-&gt;</span> <span class="pre">kim</span> <span class="pre">-&gt;</span> <span class="pre">teresa</span></code>, or the
path <code class="docutils literal notranslate"><span class="pre">alice</span> <span class="pre">-&gt;</span> <span class="pre">teresa</span></code>, or the path <code class="docutils literal notranslate"><span class="pre">alice</span> <span class="pre">-&gt;</span> <span class="pre">bob</span> <span class="pre">-&gt;</span> <span class="pre">clara</span></code>, and in
all of them, each package only appears once.</p>
<p>But if <code class="docutils literal notranslate"><span class="pre">clara</span></code> was to depend on <code class="docutils literal notranslate"><span class="pre">alice</span></code> this would change:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>alice &lt;----------------------------,
  |                                |
  |                                |
  `---+------------,               |
      |            |               |
      V            V               |
     bob         teresa &lt;-----,    |
      |                       |    |
      |                       |    |
      `---+--------,          |    |
          |        |          |    |
          V        V          |    |
        clara     kim         |    |
          |        |          |    |
          |        |          |    |
          |        `----------'    |
          |                        |
          `------------------------'
</pre></div>
</div>
<p>Now our previous <code class="docutils literal notranslate"><span class="pre">alice</span> <span class="pre">-&gt;</span> <span class="pre">bob</span> <span class="pre">-&gt;</span> <span class="pre">clara</span></code> path becomes
<code class="docutils literal notranslate"><span class="pre">alice</span> <span class="pre">-&gt;</span> <span class="pre">bob</span> <span class="pre">-&gt;</span> <span class="pre">clara</span> <span class="pre">-&gt;</span> <span class="pre">alice</span> <span class="pre">-&gt;</span> <span class="pre">bob</span> <span class="pre">-&gt;</span> <span class="pre">clara</span> <span class="pre">-&gt;</span> <span class="pre">alice</span> <span class="pre">-&gt;</span> <span class="pre">...</span></code>.
So <code class="docutils literal notranslate"><span class="pre">alice</span></code> is granting powers to <code class="docutils literal notranslate"><span class="pre">bob</span></code>, and <code class="docutils literal notranslate"><span class="pre">bob</span></code> is granting
powers to <code class="docutils literal notranslate"><span class="pre">clara</span></code>, but how would <code class="docutils literal notranslate"><span class="pre">clara</span></code> then be the one to grant
powers to <code class="docutils literal notranslate"><span class="pre">alice</span></code>? <code class="docutils literal notranslate"><span class="pre">clara</span></code> cannot just materialise capabilities out
of thin air if <code class="docutils literal notranslate"><span class="pre">alice</span></code> has more requirements, so it’s not possible
for these arrangements to be resolved by Crochet.</p>
</div>
</div>
</div>

      </article>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="dynamic.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Dynamic capabilities</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="why.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Why use capabilities?</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; 2021, Q.
            |
            Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
              and
              <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
              <a href="https://github.com/pradyunsg/furo">Furo theme</a>.
            |
            <a class="muted-link" href="../../_sources/system/security/groups.rst.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Capabilities and groups</a><ul>
<li><a class="reference internal" href="#primordial-capabilities">Primordial capabilities</a></li>
<li><a class="reference internal" href="#types-as-capabilities">Types as capabilities</a><ul>
<li><a class="reference internal" href="#granting-type-capabilities">Granting type capabilities</a></li>
</ul>
</li>
<li><a class="reference internal" href="#capability-groups">Capability groups</a></li>
<li><a class="reference internal" href="#propagating-capabilities">Propagating capabilities</a><ul>
<li><a class="reference internal" href="#a-note-on-cycles">A note on cycles</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </main>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/scripts/main.js"></script>
    </body>
</html>