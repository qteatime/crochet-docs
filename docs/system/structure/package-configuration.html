<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Data and types" href="../types/index.html" /><link rel="prev" title="The Crochet universe" href="introduction.html" />

    <meta name="generator" content="sphinx-4.1.1, furo 2021.07.05.beta38"/>
        <title>Package configuration - Crochet 0.12 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/crochet.css" />
    


<style>
  :root {
    --color-code-background: #ffffff;
  --color-code-foreground: black;
  
  }
  @media (prefers-color-scheme: dark) {
    :root {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }

  /* For allowing end-user-specific overrides */
  .override-light {
    --color-code-background: #ffffff;
  --color-code-foreground: black;
  
  }
  .override-dark {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
</style><link media="(prefers-color-scheme: dark)" rel="stylesheet" href="../../_static/pygments_dark.css"></head>
  <body dir="">
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke-width="1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z"/>
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
      class="feather feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
      class="feather feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Crochet 0.12 documentation</div></a>
    </div>
    <div class="header-right">
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">Crochet 0.12 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html">
  <input class="sidebar-search" placeholder=Search name="q">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">The Crochet System</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label for="toctree-checkbox-1"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../whats-crochet.html">What’s Crochet?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installing-crochet.html">Installing Crochet</a></li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">How is Crochet structured?</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label for="toctree-checkbox-2"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="introduction.html">The Crochet universe</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Package configuration</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../types/index.html">Data and types</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label for="toctree-checkbox-3"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../types/types-and-data.html">Types and data modelling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../types/hierarchies.html">Hierarchies of types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../types/traits.html">Traits</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../commands/index.html">Commands</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label for="toctree-checkbox-4"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../commands/declaration.html">What are commands?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/signatures.html">Signatures and their uses</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/dispatch.html">Executing commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/why.html">Why are commands …?</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../computing/index.html">Computing with Crochet</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label for="toctree-checkbox-5"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../computing/execution-models.html">Execution models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../computing/bindings.html">Naming values</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../computing/intrinsics/index.html">Intrinsic data types</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label for="toctree-checkbox-6"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../computing/intrinsics/gradual.html">Gradual representations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../computing/intrinsics/numbers.html">Numeric models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../computing/intrinsics/text.html">Textual models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../computing/intrinsics/logic.html">Logical models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../computing/intrinsics/functions.html">Program representations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../computing/intrinsics/collections.html">Collections</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../computing/application.html">Applying programs and commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="../computing/using.html">Using data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../computing/equality.html">Equality</a></li>
<li class="toctree-l3"><a class="reference internal" href="../computing/branching.html">Branching</a></li>
<li class="toctree-l3"><a class="reference internal" href="../computing/comprehension.html">Working with multiple values</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../effects/index.html">Effects</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label for="toctree-checkbox-7"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../effects/what-are-effects.html">What are effects?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../effects/handlers.html">Effect handlers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../effects/contexts.html">Contextual handlers</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../verification/index.html">Verification</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label for="toctree-checkbox-8"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../verification/examples.html">Example-based testing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../verification/contracts.html">Contracts</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../ffi/index.html">Foreign interfaces</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label for="toctree-checkbox-9"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../ffi/interface.html">Writing external functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ffi/ffi.html">The FFI type</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../security/index.html">Security and capabilities</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label for="toctree-checkbox-10"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../security/why.html">Why use capabilities?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/groups.html">Capabilities and groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/dynamic.html">Dynamic capabilities</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../design-philosophy.html">Annex A: Design philosophy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sociology-and-linguistics.html">Annex B: Sociology and linguistics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <main class="main">
    <div class="content">
      <article role="main">
        <label class="toc-overlay-icon toc-content-icon" for="__toc">
          <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
        </label>
        <div class="section" id="package-configuration">
<span id="id1"></span><h1>Package configuration<a class="headerlink" href="#package-configuration" title="Permalink to this headline">¶</a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The package configuration side of Crochet is heavily in flux, and the
ideas described here <em>will</em> change soon. This is one reason why this
page is not written in the same style as the other pages in this
documentation.</p>
</div>
<p>A package in Crochet is described by a folder with a <code class="docutils literal notranslate"><span class="pre">crochet.json</span></code> file.
This file describes everything a package contains—essentially, this is a
header for a package image. Storing this image using a file system’s nodes
is just an implementation detail—although currently it’s the only
implementation too.</p>
<div class="section" id="the-meta-data-section">
<h2>The meta-data section<a class="headerlink" href="#the-meta-data-section" title="Permalink to this headline">¶</a></h2>
<p>A package must contain some meta-data attributes that describe to the
system what the package is, how it can be referenced, and why one should
trust it.</p>
<p>The following root-level fields are part of the meta-data section:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">name</span></code> (string, required)</dt><dd><p>An unique name for the package. To reduce synchronisation on this, we
use the reverse-domain convention popular in Java.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">title</span></code> (string, optional)</dt><dd><p>A more friendly name shown to users in the Launcher. <code class="docutils literal notranslate"><span class="pre">name</span></code> is used
if this is not available.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">description</span></code> (string, optional)</dt><dd><p>A very short description of what the package does.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">stability</span></code> (string enum, optional)</dt><dd><p>An indication of the maturity of the overall package. Can be one of:
<code class="docutils literal notranslate"><span class="pre">"deprecated"</span></code>, <code class="docutils literal notranslate"><span class="pre">"experimental"</span></code>, <code class="docutils literal notranslate"><span class="pre">"stable"</span></code>, or <code class="docutils literal notranslate"><span class="pre">"immutable"</span></code>
(which means only security patches are allowed).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">target</span></code> (string enum, optional)</dt><dd><p>The platforms the package is available on. This is currently a very
restricted idea of target and will change in the future. The possible
values are <code class="docutils literal notranslate"><span class="pre">*</span></code> (all platforms), <code class="docutils literal notranslate"><span class="pre">node</span></code>, and <code class="docutils literal notranslate"><span class="pre">browser</span></code>.</p>
</dd>
</dl>
</div>
<div class="section" id="the-sources-section">
<h2>The sources section<a class="headerlink" href="#the-sources-section" title="Permalink to this headline">¶</a></h2>
<p>In the sources section, the package needs to describe which pieces of
code are part of the package. Sources can be written in any language
the Crochet system has a compiler for—the VM can only read binary
images in the <code class="docutils literal notranslate"><span class="pre">.croc</span></code> format, so the compiler must be able to output
that. Compilers are chosen based on the extension part of the file name.</p>
<p>The current natively supported languages are: <code class="docutils literal notranslate"><span class="pre">.crochet</span></code> and <code class="docutils literal notranslate"><span class="pre">.lingua</span></code>.</p>
<p>Fields in this section (at the root of the file) are:</p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">sources</span></code> (array of files, required)</dt><dd><p>A list of all sources that are to be loaded and executed by the Crochet VM.
These can be in any language Crochet has a compiler for.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">native_sources</span></code> (array of files, required)</dt><dd><p>A list of all sources that are to be loaded natively by the operating
system in order to provide functionality that Crochet can bind to through
<code class="docutils literal notranslate"><span class="pre">foreign</span></code> clauses. Currently this only supports JavaScript.</p>
<p>In order to be able to load native sources, the package must receive the
<code class="docutils literal notranslate"><span class="pre">native</span></code> capability from its parent package (or from the user).</p>
</dd>
</dl>
<p>Each item in the array is a file. A file is described by the following
type:</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="kd">type</span> <span class="nx">File</span> <span class="o">=</span> <span class="kt">string</span> <span class="o">|</span> <span class="p">{</span>
  <span class="nx">name</span>: <span class="kt">string</span><span class="p">;</span>
  <span class="nx">target</span>: <span class="kt">Target</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>A file that is not described with a target is unconditionally included
every time the package is loaded. Files with a target can be conditionally
loaded based on the platform it’s running and available capabilities.</p>
</div>
<div class="section" id="the-dependencies-section">
<h2>The dependencies section<a class="headerlink" href="#the-dependencies-section" title="Permalink to this headline">¶</a></h2>
<p>Packages may depend on other packages. But dependencies form an acyclic
graph due to how capability propagation works, thus if package A depends
on package B, that means package B cannot depend on anything that ultimately
depends on package A.</p>
<p>There’s only one field (at the root) in this section:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">dependencies</span></code> (list of dependency, required)</dt><dd><p>A list of all packages that this package depends on. Most packages will
depend at least on <code class="docutils literal notranslate"><span class="pre">crochet.core</span></code>, since there’s not much Crochet can
do out of the box.</p>
</dd>
</dl>
<p>Each dependency has to following type:</p>
<div class="highlight-typescript notranslate"><div class="highlight"><pre><span></span><span class="kd">type</span> <span class="nx">Dependency</span> <span class="o">=</span> <span class="kt">string</span> <span class="o">|</span> <span class="p">{</span>
  <span class="nx">name</span>: <span class="kt">string</span><span class="p">;</span>
  <span class="nx">target</span>: <span class="kt">Target</span><span class="p">;</span>
  <span class="nx">capabilities</span>: <span class="kt">Capability</span><span class="p">[]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The string format describes an unconditionally loaded dependency with
no capability propagation—that means that the package will not be able
to do anything <em>powerful</em> (only pure computations). The object format allows
controlling when the package is loaded and which capabilities it gets from
the parent package.</p>
</div>
<div class="section" id="the-capabilities-section">
<h2>The capabilities section<a class="headerlink" href="#the-capabilities-section" title="Permalink to this headline">¶</a></h2>
<p>The capabilities section describes both the capabilities that the
package defines and the capabilities that it needs in order to work.
There is currently no support for optional or dynamic capabilities,
but that’s planned for the future.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">capabilities</span></code> field at the root is the only component of this
section, and it allows the following fields:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">provides</span></code> (list of name, required)</dt><dd><p>This describes all capability groups that are <em>exported</em> from the
package and available for outsiders to use. The name is simply the
name of the capability group, unqualified.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">requires</span></code> (list of qualified name, required)</dt><dd><p>This describes all capability groups that the package <em>requires</em>
from the parent in order for it to work. This is the fully qualified
capability group name, e.g.: <code class="docutils literal notranslate"><span class="pre">crochet.random/read-shared-instance</span></code>.</p>
</dd>
</dl>
</div>
</div>

      </article>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../types/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Data and types</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="introduction.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">The Crochet universe</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; 2021, Q.
            |
            Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
              and
              <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
              <a href="https://github.com/pradyunsg/furo">Furo theme</a>.
            |
            <a class="muted-link" href="../../_sources/system/structure/package-configuration.rst.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Package configuration</a><ul>
<li><a class="reference internal" href="#the-meta-data-section">The meta-data section</a></li>
<li><a class="reference internal" href="#the-sources-section">The sources section</a></li>
<li><a class="reference internal" href="#the-dependencies-section">The dependencies section</a></li>
<li><a class="reference internal" href="#the-capabilities-section">The capabilities section</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </main>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/scripts/main.js"></script>
    </body>
</html>